
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>segreg.model.alt.brute_fit_two_bkpt &#8212; segreg 1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code Generalities" href="../code_generalities.html" />
    <link rel="prev" title="segreg.model.alt.brute_fit_one_bkpt" href="segreg.model.alt.brute_fit_one_bkpt.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../code_generalities.html" title="Code Generalities"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="segreg.model.alt.brute_fit_one_bkpt.html" title="segreg.model.alt.brute_fit_one_bkpt"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">segreg 1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">segreg.model.alt.brute_fit_two_bkpt</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="segreg-model-alt-brute-fit-two-bkpt">
<h1>segreg.model.alt.brute_fit_two_bkpt<a class="headerlink" href="#segreg-model-alt-brute-fit-two-bkpt" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="segreg.model.alt.brute_fit_two_bkpt">
<span class="sig-name descname"><span class="pre">brute_fit_two_bkpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_end_to_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_between_to_skip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#segreg.model.alt.brute_fit_two_bkpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate two-bkpt segmented regression model using a brute-force method.</p>
<p>This method is limited to univariate, continuous, linear, two-bkpt
segmented regression problems.  Estimates the parameters:</p>
<p><code class="docutils literal notranslate"><span class="pre">[u1,</span> <span class="pre">v1,</span> <span class="pre">u2,</span> <span class="pre">v2,</span> <span class="pre">m1,</span> <span class="pre">m2]</span></code></p>
<p>where</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(u1,v1),</span> <span class="pre">(u2,</span> <span class="pre">v2)</span></code> are the breakpoints (in x-y plane), ordered such
that <code class="docutils literal notranslate"><span class="pre">u1</span> <span class="pre">&lt;</span> <span class="pre">u2</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">m1</span></code> is the slope of the left-most segment</p>
<p><code class="docutils literal notranslate"><span class="pre">m2</span></code> is the slope of the right-most segment</p>
</div></blockquote>
<p class="rubric">Notes</p>
<p>This method picks the parameters giving the minimum RSS by brute-force
calculation on a grid in the space of bkpt parameters, <code class="docutils literal notranslate"><span class="pre">(u1,</span> <span class="pre">u2)</span></code>.  That
is, for each choice of bkpt pairs, the method computes the RSS for the
segmented fit conditional on the bkpt pair. The parameters corresponding to
the overall minimal RSS from these calculations are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indep</strong> (<em>numpy array of shape</em><em> (</em><em>num_data</em><em>,</em><em>)</em>) – The independent data.  Also called predictor, explanatory variable,
regressor, or exogenous variable.</p></li>
<li><p><strong>dep</strong> (<em>numpy array of shape</em><em> (</em><em>num_data</em><em>,</em><em>)</em>) – The dependent data.  Also called response, regressand, or endogenous
variable.</p></li>
<li><p><strong>num_end_to_skip</strong> (<em>int</em>) – Number of data points to skip at each end of the data when solving for
the bkpts.  As such, this determines a guaranteed minimum number of data
points in the left and right segments in the returned fit.
If None, defaults to the underlying implementation.
TODO: explain</p></li>
<li><p><strong>num_between_to_skip</strong> (<em>int</em>) – Number of data points to skip between the two bkpts (ie: the middle
segment) when solving for the bkpts.  Specifically, for each choice of
left bkpt <code class="docutils literal notranslate"><span class="pre">u1</span></code>, will skip this many data points between <code class="docutils literal notranslate"><span class="pre">u1</span></code> and
<code class="docutils literal notranslate"><span class="pre">u2</span></code>.  As such, this determines a guaranteed minimum number of data
points between the bkpts in the returned fit.</p></li>
<li><p><strong>dx</strong> (<em>float</em>) – The stepsize for the grid search.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – </p></li>
<li><p><strong>extra_verbose</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">segreg.model.alt</span> <span class="kn">import</span> <span class="n">brute_fit_two_bkpt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">brute_fit_two_bkpt</span><span class="p">(</span><span class="n">indep</span><span class="p">,</span> <span class="n">dep</span><span class="p">)</span>
<span class="go">(array([ 5.,  5., 10., -0.,  1.,  1.]), 0.0)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>params</strong> (<em>array of shape (num_params,)</em>) – The estimated parameters.  The returned parameters are, in order,
[u, v, m1, m2].</p></li>
<li><p><strong>rss</strong> (<em>float</em>) – Residual sum of squares of the fit.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="segreg.model.alt.brute_fit_one_bkpt.html"
                        title="previous chapter">segreg.model.alt.brute_fit_one_bkpt</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../code_generalities.html"
                        title="next chapter">Code Generalities</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/_autosummary/segreg.model.alt.brute_fit_two_bkpt.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../code_generalities.html" title="Code Generalities"
             >next</a> |</li>
        <li class="right" >
          <a href="segreg.model.alt.brute_fit_one_bkpt.html" title="segreg.model.alt.brute_fit_one_bkpt"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">segreg 1.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >API</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">segreg.model.alt.brute_fit_two_bkpt</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Steven Lillywhite.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
  </body>
</html>